# Интеллектуальный голосовой помощник машиниста

Репозиторий содержит решение кейса от ОАО "РЖД" в рамках всероссийского хакатона "Цифровой прорыв"

## Постановка задачи

Необходимо создать программный алгоритм и библиотеку рекомендаций для машинистов, связанных с разными неисправностями и отказами технических средств. Алгоритм должен:
- Фильтровать фоновый шум и распознавать различные акценты, диалекты, железнодорожные термины и англицизмы в речи.
- Предоставлять машинисту правильные инструкции в соответствии с техническими нормами.
- Понимать смысл запроса и предоставлять качественные и понятные ответы.
- Работать локально и не требовать больших вычислительных ресурсов.

## Решение

Наше решение состоит из нескольких модулей:
- Модуль преобразования голоса в текст (STT).
- Модуль поиска в базе данных text2text.
- Модуль преобразования текста в голос, приятный уху машиниста (TTS).
- Интерфейс  в виде android и веб приложения.

**Технологический стек:** `Python`, `PyTorch`, `NeMo`, `FastAPI`, `Flutter`, `Docker`, `Silero`, `Vector Database`

## Модуль 1. Speech-To-Text

Модуль для преобразования голоса машиниста в текст для последующий обработки. 
- Обработка аудио с целью убрать лишний шум.
- Обработка очищенного аудио с целью преобразования в текст.

В качестве модели распознавания речи использовали открытую нейросеть, обученную компанию **NVIDIA Conformer-Transducer Large (Russian)**

Точность модели: метрика **WER = 5.1%**

Код: [rzd/stt.py](rzd/stt.py)

## Модуль 2. text2text ret

Высокогибкий модуль, позволяющий решать задачу поиска текста в базе данных.
- Выделение мысли и смысла текста в его эссенцию, заключенную в векторном представлении.
- Поиск в многомерном векторном пространстве среди всевозможных ответов, удовлетворяющих нашим требованиям.

В качестве кодировщика текста используем открытую предобученную модель **LaBSE**

**Точность** полученного решения **97%** на валидационных данных

Пример запроса: `сломалось релу ру6.`

Пример ответа (top-1): 
```
"topic": "При нажатии кнопки "Пуск дизеля" маслопрокачивающий насос не работает", 
"malfunction": "Не включилось РУ6",
 "cause": "Перегорел предохранитель ПР-3",
 "elimination": "Заменить перегоревший предохранитель ПР3 125 А",
 "cos_sim": 0.931
```

Код: [rzd/information_retrieval.py](rzd/information_retrieval.py)

## Модуль 3. Text-To-Speech

Модуль для преобразования текста возможного решения проблемы в звук, приятный для ушей машиниста.
- Предобработка всевозможных аббревиатур, цифр, чисел, констант, англицизмов в виде кириллических написаний.
- Преобразование текста непосредственно в звуковые волны с частотой семплирования 24000.

Код: [rzd/tts.py](rzd/tts.py)

## Подсчет метрик

Подсчет метрик реализован в ноутбуке [validation/calculate_metrics.ipynb](validation/calculate_metrics.ipynb)

![alt text](https://i.ibb.co/0BN1Wkf/metrics.png)
